import{r as l,j as e,H as re,F as ie}from"./app-DqdLS_po.js";import{A as ne,V as F,X as le,Y as de}from"./app-layout-BY_z2l7K.js";import{I as d}from"./input-error-CfDIxQqe.js";import{B as o}from"./button-DVQP8ugw.js";import{b as k,C as S,a as w,c as z}from"./card-z2brvHDy.js";import{C as oe}from"./checkbox-D2zvUl2l.js";import{I as x}from"./input-CikxobFJ.js";import{L as n}from"./label-CKEEuidP.js";import{c as u,a as m,b as h,S as p,d as c}from"./select-HYGYj5Xd.js";import{S as L}from"./separator-DGAiZpJH.js";import{A as ce}from"./arrow-left-DyOQbVss.js";import{C as ue}from"./circle-dollar-sign-BZRWRA1r.js";import{P as M}from"./plus-fUC_Frcj.js";import{C as B,S as me}from"./save-CcLVDqIY.js";import{P as he}from"./index-CxeexwSe.js";/* empty css            */import"./index-CJ7mWlm-.js";import"./x-C_vLIVyO.js";import"./index-oTu_XNBi.js";import"./Combination-CjQPbJWN.js";import"./index-BY9hahA7.js";import"./index-CSEUMRIG.js";import"./SaleController-CWOAsHby.js";import"./index-CHdNXJ1h.js";import"./index-B_e8Ugpt.js";import"./app-logo-icon-BquCEMUK.js";import"./building-2-q9KNC_Mq.js";import"./warehouse-CXlB-vPY.js";import"./store-B14O_uPo.js";import"./square-user-BhCGZFIc.js";import"./truck-D0hplmIV.js";import"./index-CQuKHLBU.js";import"./check-CFlOe0yf.js";const pe=[{title:"Dashboard",href:"/dashboard"},{title:"Transferts",href:F().url},{title:"Nouveau transfert",href:"#"}];let W=1,xe=1;function Ge({warehouses:I,shops:H,products:R,vehicles:q,chargeTypes:K}){const[j,Q]=l.useState(""),[$,X]=l.useState(""),[E,T]=l.useState(""),[V,D]=l.useState(""),[g,Y]=l.useState(""),[G,J]=l.useState(""),[O,U]=l.useState(""),[v,Z]=l.useState(!1),[f,y]=l.useState([{key:W++,product_id:"",quantity_requested:"1"}]),[N,b]=l.useState([]),[C,A]=l.useState(!1);function ee(){y(i=>[...i,{key:W++,product_id:"",quantity_requested:"1"}])}function se(i){y(r=>r.filter(s=>s.key!==i))}function P(i,r,s){y(t=>t.map(a=>a.key===i?{...a,[r]:s}:a))}function ae(){b(i=>[...i,{key:xe++,label:"",type:"",amount:"",notes:""}])}function te(i){b(r=>r.filter(s=>s.key!==i))}function _(i,r,s){b(t=>t.map(a=>a.key===i?{...a,[r]:s}:a))}return e.jsxs(ne,{breadcrumbs:pe,children:[e.jsx(re,{title:"Nouveau transfert"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(o,{asChild:!0,variant:"ghost",size:"icon",className:"size-8",children:e.jsxs("a",{href:F().url,children:[e.jsx(ce,{className:"size-4"}),e.jsx("span",{className:"sr-only",children:"Retour"})]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Nouveau transfert"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Transférez des produits entre entrepôts ou vers un magasin"})]})]}),e.jsx(L,{}),e.jsx(ie,{...de.store.form(),children:({processing:i,errors:r})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mx-auto w-full max-w-2xl space-y-6",children:[e.jsxs(k,{children:[e.jsx(S,{children:e.jsxs(w,{className:"flex items-center gap-2 text-base",children:[e.jsx(le,{className:"size-4"}),"Détails du transfert"]})}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(n,{htmlFor:"type",children:["Type de transfert ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(u,{value:j,onValueChange:s=>{Q(s),T(""),D("")},children:[e.jsx(m,{id:"type",children:e.jsx(h,{placeholder:"Sélectionner un type"})}),e.jsxs(p,{children:[e.jsx(c,{value:"warehouse_to_shop",children:"Entrepôt → Magasin"}),e.jsx(c,{value:"warehouse_to_warehouse",children:"Entrepôt → Entrepôt"})]})]}),e.jsx("input",{type:"hidden",name:"type",value:j}),e.jsx(d,{message:r.type})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(n,{htmlFor:"source_warehouse_id",children:["Entrepôt source ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(u,{value:$,onValueChange:X,children:[e.jsx(m,{id:"source_warehouse_id",children:e.jsx(h,{placeholder:"Source"})}),e.jsx(p,{children:I.map(s=>e.jsxs(c,{value:s.id,children:[s.name," (",s.code,")"]},s.id))})]}),e.jsx("input",{type:"hidden",name:"source_warehouse_id",value:$}),e.jsx(d,{message:r.source_warehouse_id})]}),j==="warehouse_to_warehouse"&&e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(n,{htmlFor:"destination_warehouse_id",children:["Entrepôt destination ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(u,{value:E,onValueChange:T,children:[e.jsx(m,{id:"destination_warehouse_id",children:e.jsx(h,{placeholder:"Destination"})}),e.jsx(p,{children:I.map(s=>e.jsxs(c,{value:s.id,children:[s.name," (",s.code,")"]},s.id))})]}),e.jsx("input",{type:"hidden",name:"destination_warehouse_id",value:E}),e.jsx(d,{message:r.destination_warehouse_id})]}),j==="warehouse_to_shop"&&e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(n,{htmlFor:"destination_shop_id",children:["Magasin destination ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(u,{value:V,onValueChange:D,children:[e.jsx(m,{id:"destination_shop_id",children:e.jsx(h,{placeholder:"Magasin"})}),e.jsx(p,{children:H.map(s=>e.jsxs(c,{value:s.id,children:[s.name," (",s.code,")"]},s.id))})]}),e.jsx("input",{type:"hidden",name:"destination_shop_id",value:V}),e.jsx(d,{message:r.destination_shop_id})]})]}),(q?.length??0)>0&&e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"vehicle_id",children:"Véhicule"}),e.jsxs(u,{value:g||void 0,onValueChange:Y,children:[e.jsx(m,{id:"vehicle_id",children:e.jsx(h,{placeholder:"Sélectionner un véhicule (optionnel)"})}),e.jsx(p,{children:q.map(s=>e.jsxs(c,{value:s.id,children:[s.name," (",s.registration_number,")"]},s.id))})]}),g&&e.jsx("input",{type:"hidden",name:"vehicle_id",value:g}),e.jsx(d,{message:r.vehicle_id})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"notes",children:"Notes"}),e.jsx("textarea",{id:"notes",name:"notes",rows:2,placeholder:"Notes supplémentaires…",className:"border-input bg-background placeholder:text-muted-foreground focus-visible:ring-ring flex min-h-[60px] w-full rounded-md border px-3 py-2 text-sm shadow-xs focus-visible:ring-1 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50"}),e.jsx(d,{message:r.notes})]}),e.jsx(L,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"driver_name",children:"Nom du chauffeur"}),e.jsx(x,{id:"driver_name",name:"driver_name",value:G,onChange:s=>J(s.target.value),placeholder:"Nom du chauffeur"}),e.jsx(d,{message:r.driver_name})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"driver_phone",children:"Téléphone du chauffeur"}),e.jsx(x,{id:"driver_phone",name:"driver_phone",value:O,onChange:s=>U(s.target.value),placeholder:"Numéro de téléphone"}),e.jsx(d,{message:r.driver_phone})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{id:"company_bears_costs",checked:v,onCheckedChange:s=>Z(s===!0)}),e.jsx(n,{htmlFor:"company_bears_costs",className:"font-normal",children:"L'entreprise prend en charge les frais de transport"}),e.jsx("input",{type:"hidden",name:"company_bears_costs",value:v?"1":"0"})]})]})]}),v&&e.jsxs(k,{children:[e.jsx(S,{children:e.jsxs(w,{className:"flex items-center justify-between text-base",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"size-4"}),"Frais logistiques (",N.length,")"]}),e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:ae,children:[e.jsx(M,{className:"size-4"}),"Ajouter"]})]})}),e.jsxs(z,{className:"space-y-4",children:[N.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Aucun frais ajouté. Cliquez sur « Ajouter » pour enregistrer des frais logistiques."}),N.map((s,t)=>e.jsxs("div",{className:"flex items-end gap-3 rounded-lg border bg-muted/20 p-3",children:[e.jsxs("div",{className:"grid flex-1 gap-2",children:[e.jsx(n,{htmlFor:`charge-${t}-label`,children:"Libellé"}),e.jsx(x,{id:`charge-${t}-label`,name:`charges[${t}][label]`,value:s.label,onChange:a=>_(s.key,"label",a.target.value),placeholder:"Ex: Carburant Cotonou-Parakou"})]}),e.jsxs("div",{className:"grid w-40 gap-2",children:[e.jsx(n,{htmlFor:`charge-${t}-type`,children:"Type"}),e.jsxs(u,{value:s.type,onValueChange:a=>_(s.key,"type",a),children:[e.jsx(m,{id:`charge-${t}-type`,children:e.jsx(h,{placeholder:"Type"})}),e.jsx(p,{children:(K??[]).map(a=>e.jsx(c,{value:a.value,children:a.label},a.value))})]}),e.jsx("input",{type:"hidden",name:`charges[${t}][type]`,value:s.type})]}),e.jsxs("div",{className:"grid w-28 gap-2",children:[e.jsx(n,{htmlFor:`charge-${t}-amount`,children:"Montant"}),e.jsx(x,{id:`charge-${t}-amount`,name:`charges[${t}][amount]`,type:"number",min:"0",value:s.amount,onChange:a=>_(s.key,"amount",a.target.value)})]}),e.jsx(o,{type:"button",variant:"ghost",size:"icon",className:"mb-0.5 size-9 shrink-0 text-destructive hover:text-destructive",onClick:()=>te(s.key),children:e.jsx(B,{className:"size-4"})})]},s.key))]})]}),e.jsxs(k,{children:[e.jsx(S,{children:e.jsxs(w,{className:"flex items-center justify-between text-base",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"size-4"}),"Produits à transférer (",f.length,")"]}),e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:ee,children:[e.jsx(M,{className:"size-4"}),"Ajouter"]})]})}),e.jsxs(z,{className:"space-y-4",children:[f.map((s,t)=>e.jsxs("div",{className:"flex items-end gap-3 rounded-lg border bg-muted/20 p-3",children:[e.jsxs("div",{className:"grid flex-1 gap-2",children:[e.jsxs(n,{htmlFor:`items-${t}-product`,children:["Produit ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(u,{value:s.product_id,onValueChange:a=>P(s.key,"product_id",a),children:[e.jsx(m,{id:`items-${t}-product`,children:e.jsx(h,{placeholder:"Choisir"})}),e.jsx(p,{children:R.map(a=>e.jsxs(c,{value:a.id,children:[a.name," (",a.code,")"]},a.id))})]}),e.jsx("input",{type:"hidden",name:`items[${t}][product_id]`,value:s.product_id}),e.jsx(d,{message:r[`items.${t}.product_id`]})]}),e.jsxs("div",{className:"grid w-28 gap-2",children:[e.jsx(n,{htmlFor:`items-${t}-qty`,children:"Quantité"}),e.jsx(x,{id:`items-${t}-qty`,name:`items[${t}][quantity_requested]`,type:"number",min:"1",value:s.quantity_requested,onChange:a=>P(s.key,"quantity_requested",a.target.value)}),e.jsx(d,{message:r[`items.${t}.quantity_requested`]})]}),f.length>1&&e.jsx(o,{type:"button",variant:"ghost",size:"icon",className:"mb-0.5 size-9 shrink-0 text-destructive hover:text-destructive",onClick:()=>se(s.key),children:e.jsx(B,{className:"size-4"})})]},s.key)),e.jsx(d,{message:r.items})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-2",children:[e.jsx(o,{type:"button",variant:"outline",asChild:!0,children:e.jsx("a",{href:F().url,children:"Annuler"})}),e.jsx("input",{type:"hidden",name:"is_draft",value:C?"1":"0"}),e.jsxs(o,{type:"submit",variant:"secondary",disabled:i,onClick:()=>A(!0),children:[e.jsx(me,{className:"size-4"}),i&&C?"Enregistrement…":"Sauvegarder brouillon"]}),e.jsx(o,{type:"submit",disabled:i,onClick:()=>A(!1),children:i&&!C?"Enregistrement…":"Créer le transfert"})]})]})})]})]})}export{Ge as default};
